test_run = require('test_run').new()
---
...
test_run:cmd("push filter ".."'\\.lua.*:[0-9]+: ' to '.lua:<line>\"]: '")
---
- true
...
digest = require('digest')
---
...
type(digest)
---
- table
...
--
-- Invalid arguments
--
digest.sha3_224()
---
- error: 'builtin/crypto.lua:<line>"]: Usage: digest.sha3_224(string)'
...
digest.sha3_256()
---
- error: 'builtin/crypto.lua:<line>"]: Usage: digest.sha3_256(string)'
...
digest.sha3_384()
---
- error: 'builtin/crypto.lua:<line>"]: Usage: digest.sha3_384(string)'
...
digest.sha3_512()
---
- error: 'builtin/crypto.lua:<line>"]: Usage: digest.sha3_512(string)'
...
digest.sha3_224_hex()
---
- error: 'builtin/digest.lua:<line>"]: Usage: digest.sha3_224_hex(string)'
...
digest.sha3_256_hex()
---
- error: 'builtin/digest.lua:<line>"]: Usage: digest.sha3_256_hex(string)'
...
digest.sha3_384_hex()
---
- error: 'builtin/digest.lua:<line>"]: Usage: digest.sha3_384_hex(string)'
...
digest.sha3_512_hex()
---
- error: 'builtin/digest.lua:<line>"]: Usage: digest.sha3_512_hex(string)'
...
--
-- gh-1561: Bad checksum on non-string types
--
digest.sha3_224(12345LL)
---
- error: 'builtin/crypto.lua:<line>"]: Usage: digest.sha3_224(string)'
...
digest.sha3_256(12345LL)
---
- error: 'builtin/crypto.lua:<line>"]: Usage: digest.sha3_256(string)'
...
digest.sha3_384(12345LL)
---
- error: 'builtin/crypto.lua:<line>"]: Usage: digest.sha3_384(string)'
...
digest.sha3_512(12345LL)
---
- error: 'builtin/crypto.lua:<line>"]: Usage: digest.sha3_512(string)'
...
--
-- Empty string
--
digest.sha3_224('')
---
- !!binary a04DQjZn27c7bhVFTw6xq9RZf5obB44/W1prxw==
...
digest.sha3_256('')
---
- !!binary p//G+L8e12ZRwUdWoGHWYvWA/03kO0n6gtgKS4D4Q0o=
...
digest.sha3_384('')
---
- !!binary DGOnW4ReT30BEH2FLkwkhcUaUKqqlPxhmV5xu+6YOirDcTgxJkrbR/tr0eBY1fAE
...
digest.sha3_512('')
---
- !!binary pp9zzKI6msXItWfcGFp1bpfJghZP4lhZ4NHcwUdcgKYVshI68fX5TBHj6UAsOsVY9QAZnZW20+MBdYWGKB3NJg==
...
digest.sha3_224_hex('')
---
- 6b4e03423667dbb73b6e15454f0eb1abd4597f9a1b078e3f5b5a6bc7
...
digest.sha3_256_hex('')
---
- a7ffc6f8bf1ed76651c14756a061d662f580ff4de43b49fa82d80a4b80f8434a
...
digest.sha3_384_hex('')
---
- 0c63a75b845e4f7d01107d852e4c2485c51a50aaaa94fc61995e71bbee983a2ac3713831264adb47fb6bd1e058d5f004
...
digest.sha3_512_hex('')
---
- a69f73cca23a9ac5c8b567dc185a756e97c982164fe25859e0d1dcc1475c80a615b2123af1f5f94c11e3e9402c3ac558f500199d95b6d3e301758586281dcd26
...
--
-- Non-empty string
--
digest.sha3_224('tarantool')
---
- !!binary yq6XJOGMkAeohQJZQPHAZcl0NRHRaG7+u/TKng==
...
digest.sha3_256('tarantool')
---
- !!binary 69d8DWVE9E3NDfOyF4i1D2+37/X6vutQL2ecNPXZZHc=
...
digest.sha3_384('tarantool')
---
- !!binary rwHRhuD6vjTevrKtLsvKNvekzfwo/Zcon9Kj1WUbIfjfY1F7iOKxFbgMtKtxQhFh
...
digest.sha3_512('tarantool')
---
- !!binary cglFFyb7av5BXTgdQX1upqccjYtdGEfTbaGlJJ6ivUNusqfKYimqGhDfx78YtEAQ7E9utpogS6srhALtBzIZHQ==
...
digest.sha3_224_hex('tarantool')
---
- caae9724e18c9007a885025940f1c065c9743511d1686efebbf4ca9e
...
digest.sha3_256_hex('tarantool')
---
- ebd77c0d6544f44dcd0df3b21788b50f6fb7eff5fabeeb502f679c34f5d96477
...
digest.sha3_384_hex('tarantool')
---
- af01d186e0fabe34debeb2ad2ecbca36f7a4cdfc28fd97289fd2a3d5651b21f8df63517b88e2b115b80cb4ab71421161
...
digest.sha3_512_hex('tarantool')
---
- 7209451726fb6afe415d381d417d6ea6a71c8d8b5d1847d36da1a5249ea2bd436eb2a7ca6229aa1a10dfc7bf18b44010ec4f6eb69a204bab2b8402ed0732191d
...
test_run:cmd("clear filter")
---
- true
...
